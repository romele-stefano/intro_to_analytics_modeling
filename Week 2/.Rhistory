library(ggplot2)
library("ggplot2")
library("outliers")
data <- read.table("uscrime.txt", header = TRUE)
crimes <- data$Crime
p <- ggplot(crimes)
outlier <- grubbs.test(crimes, type = 11)
data <- read.table("uscrime.txt", header = TRUE)
str(data)
crimes <- data$Crime
p <- ggplot(crimes)
crimes
outlier <- grubbs.test(crimes, type = 11)
outlier
attach(data)
par(mfrow =c (1,2), mar = c(5,4,2,2))
plot(Crime, Wealth)
points(data[which.max(data$Crime),]$Crime, data[which.max(data$Crime),]$Wealth, col = "red")
points(data[which.min(data$Crime),]$Crime, data[which.min(data$Crime),]$Wealth, col = "red")
plot(Crime, Ineq)
points(data[which.max(data$Crime),]$Crime, data[which.max(data$Crime),]$Ineq, col = "red")
points(data[which.min(data$Crime),]$Crime, data[which.min(data$Crime),]$Ineq, col = "red")
dir()
data <- read.table("temps.txt", header = T)
str(data)
head(data)
plot(data)
plot(data$X1996)
plot(data$X1996, xaxis = data$DAY)
str(data)
warnings()
data <- read.table("temps.txt", header = T)
str(data)
head(data)
data$avg <- NA
str(data)
?apply
# add new column to data frame
# find the average value over rows (1 = rows)
data$avg <- apply(data, 1, mean)
head(data)
data <- read.table("temps.txt", header = T)
# add new column to data frame
# find the average value over rows (1 = rows)
data$avg <- apply(data, 1, mean)
head(data)
warnings()
T
data <- read.table("temps.txt", header = T)
str(data)
# add new column to data frame
# find the average value over rows (1 = rows)
data$avg <- apply(data[,-1], 1, mean)
str(data)
table(data$X1996)
plot(data$avg)
plot(data$avg, data$DAY)
plot(data$DAY, data$avg)
head(data$avg)
table(data$avg)
plot(data$avg)
head(data)
tail(data)
ggplot(data, aes(x = DAY, y = avg)) + geom_point()
head(data)
=98+86+91+84+89+84+90+73+82+91+93+95+85+95+87+92+105+82+90+85
98+86+91+84+89+84+90+73+82+91+93+95+85+95+87+92+105+82+90+85
1777/20
plot(data$avg)
tail(data)
str(data)
data[70,]
cumsum(data$avg)
# find global average (this will be our μ)
avg <- mean(data$avg)
avg
head(data$avg)
table(data$avg)
avg
cusum <- 0
St <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
if (St[i-1] + (data$avg[i] - avg - 1) > 0){
St[i] = St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] = 0
}
}
# initialize variable
St <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - 1) > 0){
St[i] <- St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - 1) > 0){
St[i] <- St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
}
}
st
St
St[2]
data$avg[1] - avg - 1
data$avg[2] - avg - 1
data$avg[3] - avg - 1
data$avg[10] - avg - 1
data$avg[20] - avg - 1
data$avg[50] - avg - 1
data$avg[100] - avg - 1
if (0 + (data$avg[1] - avg - 1) > 0){
st <- ""
}
st
if (0 + (data$avg[1] - avg - 1) > 0){
st <- "c"
}
st
# initialize variable
St <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - 1) > 0){
St[i] <- St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - 1) > 0){
St[i] <- St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
}
}
St
# initialize variable
St <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - 1) > 0){
St[i] <- 0 + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - 1) > 0){
St[i] <- St[i-1] + (data$avg[i] - avg - 1)
} else {
St[i] <- 0
}
}
}
st
St
# initialize variable
st <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - 1) > 0){
st[i] <- 0 + (data$avg[i] - avg - 1)
} else {
st[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - 1) > 0){
st[i] <- st[i-1] + (data$avg[i] - avg - 1)
} else {
st[i] <- 0
}
}
}
st
head(data)
avg
# find global average (this will be our μ)
avg <- mean(data[,22])
avg
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,], 1, mean)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,-1], 1, mean)
data
data <- read.table("temps.txt", header = T)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,-1], 1, mean)
data
is.na(data$avg)
# find global average (this will be our μ)
avg <- mean(data[,22])
plot(st)
st
?ts.plot
plot(data$DAY, st)
plot(st)
which.max(st)
data[74,]
data[c(60:88),]
data[c(60:88), 22]
# find data point in data set
data[74, ]
set.seed(888)
data <- read.table("temps.txt", header = T)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,-1], 1, mean)
# find global average (this will be our μ)
avg <- mean(data[,22])
# initialize variable
st <- 0
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - 1) > 0){
st[i] <- 0 + (data$avg[i] - avg - 1)
} else {
st[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - 1) > 0){
st[i] <- st[i-1] + (data$avg[i] - avg - 1)
} else {
st[i] <- 0
}
}
}
plot(st)
# find number of observation associated with max cusum
which.max(st)
# find data point in data set
data[74, ]
set.seed(888)
data <- read.table("temps.txt", header = T)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,-1], 1, mean)
# find global average (this will be our μ)
avg <- mean(data[,22])
# initialize variable
st <- 0
C <- 3
# looping for cusum
# St= max{0,St−1+ (xt−μ−C)}
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - C) > 0){
st[i] <- 0 + (data$avg[i] - avg - C)
} else {
st[i] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - C) > 0){
st[i] <- st[i-1] + (data$avg[i] - avg - C)
} else {
st[i] <- 0
}
}
}
plot(st)
# find data point in data set associated with max value of cusum
data[which.max(st), ]
ncol(data)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data$avg <- apply(data[,-1], 2, mean)
str(data)
##### QUESTION 6.2 B
# loop over the years
set.seed(888)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data <- apply(data[,-1], 2, mean)
str(data)
set.seed(888)
data <- read.table("temps.txt", header = T)
colMeans(data)
colMeans(data[,-1])
?rbind
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data <- rbind(data, colMeans(data[,-1]))
data <- read.table("temps.txt", header = T)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data <- rbind(data, colMeans(data[,-1]))
data
tail(data)
mean(data[,2])
mean(data[,1])
mean(data[,3])
mean(data[,4])
day <- data[,1]
day
data <- data[,-1]
str(data)
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data <- rbind(data, colMeans(data[,-1]))
tail(data)
mean(data[,1])
data <- read.table("temps.txt", header = T)
str(data)
day <- data[,1]
data <- data[,-1]
# add new column to data frame
# find the average value over rows (1 = rows) for each day (this will be our X)
data <- rbind(data, colMeans(data[,-1]))
str(dta)
str(data)
tail(data)
l <- data[,1]
mean(k)
mean(l)
set.seed(888)
data <- read.table("temps.txt", header = T)
str(data)
ncol(dta)
ncol(data)
str(data)
day <- data[,1]
day
data <- data[,-day]
data <- data[,1]
str(data)
data <- read.table("temps.txt", header = T)
day <- data[,1]
data <- data[,-1]
str(data)
l <- cbind(day, data)
str(l)
head(l)
str(data)
mean(data[,1])
str(data)
head(data)
set.seed(888)
data <- read.table("temps.txt", header = T)
day <- data[,1]
data <- data[,-1]
st <- 0
# loop over columns
for (j in 1:ncol(data)){
# row avg
ravg <- mean(data[,j])
# loop over rows
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data$avg[i] - avg - C) > 0){
st[i, j] <- 0 + (data$avg[i] - avg - C)
} else {
st[i, j] <- 0
}
} else {
if (st[i-1] + (data$avg[i] - avg - C) > 0){
st[i, j] <- st[i-1] + (data$avg[i] - avg - C)
} else {
st[i, j] <- 0
}
}
}
}
st <- 0
# loop over columns
for (j in 1:ncol(data)){
# row avg
ravg <- mean(data[,j])
# loop over rows
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data[i,j] - avgr - C) > 0){
st[i, j] <- 0 + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
} else {
if (st[i-1] + (data[i,j]- avgr - C) > 0){
st[i, j] <- st[i-1] + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
}
}
}
st <- 0
# loop over columns
for (j in 1:ncol(data)){
# row avg
avgr <- mean(data[,j])
# loop over rows
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data[i,j] - avgr - C) > 0){
st[i, j] <- 0 + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
} else {
if (st[i-1] + (data[i,j]- avgr - C) > 0){
st[i, j] <- st[i-1] + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
}
}
}
data[1,1]
head(data)
set.seed(888)
data <- read.table("temps.txt", header = T)
day <- data[,1]
data <- data[,-1]
# initialized empty matrix for storing data
st <- matrix(0, nrow = nrow(data), ncol = ncol(data))
# loop over columns
for (j in 1:ncol(data)){
# row avg
avgr <- mean(data[,j])
# loop over rows
for (i in 1:nrow(data)){
# first loop
if (i == 1) {
if (0 + (data[i,j] - avgr - C) > 0){
st[i, j] <- 0 + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
} else {
if (st[i-1] + (data[i,j]- avgr - C) > 0){
st[i, j] <- st[i-1] + (data[i,j] - avgr - C)
} else {
st[i, j] <- 0
}
}
}
}
st
str(st)
st <- as.data.frame(st)
str(st)
plot(st[,1])
plot(st[,2])
plot(st[,3])
plot(st[,2])
plot(st[,4])
plot(st[,10])
plot(st[,14])
points(st[,1])
ncol(st)
?legend
str(data)
# plotting some years
plot(st[,1])
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend(1, 95, legend=c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
# plotting some years
plot(st[,1])
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend(1, 1, legend=c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
st <- as.data.frame(st)
# plotting some years
plot(st[,1])
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend(1, 150, legend=c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
?legend
# plotting some years
plot(st[,1])
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend("topright", legend=c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
st[,c(1,10,20)]
st <- as.data.frame(st)
# plotting some years
plot(st[,1], ylab = "CUSUM")
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend("topright", legend = c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
# plotting some years
plot(st[,1], ylab = "CUSUM", main = "Evolution of CUSUM over time")
points(st[,10], col = "blue")
points(st[,20], col = "red")
legend("topright", legend = c("1996", "2005", "2015"), col =c("black", "blue", "red"), lty = 1:2, cex = 0.8)
